apiVersion: v1
kind: ConfigMap
metadata:
  name: apm-config
  labels:
    k8s-app: apm
data:
  apm.yml: |
    apm-server:
      host: "0.0.0.0:8200"
      kibana:
        enabled: true
        host: kibana:5601
        path: kibana
        protocol: http
        username: {{ .Values.assemblyline.loggingUsername }}
        password: {{ .Values.assemblyline.loggingPassword }}

    logging:
      level: warning
      json: true

    output.elasticsearch:
      hosts: ['{{ .Values.assemblyline.loggingHost }}']
      username: {{ .Values.assemblyline.loggingUsername }}
      password: {{ .Values.assemblyline.loggingPassword }}

    setup.template.settings.index:
      number_of_shards: 1
      number_of_replicas: 0
